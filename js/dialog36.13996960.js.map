{"version":3,"sources":["webpack:///./shell/dialog/ScaleMachineDownDialog.vue?f022","webpack:///./shell/dialog/ScaleMachineDownDialog.vue?c653","webpack:///./shell/dialog/GenericPrompt.vue?376e","webpack:///./shell/dialog/GenericPrompt.vue?22a0","webpack:///./shell/dialog/ScaleMachineDownDialog.vue?e517","webpack:///./shell/dialog/GenericPrompt.vue?ce32","webpack:///./shell/dialog/ScaleMachineDownDialog.vue","webpack:///shell/dialog/ScaleMachineDownDialog.vue","webpack:///./shell/dialog/ScaleMachineDownDialog.vue?edbc","webpack:///./shell/dialog/ScaleMachineDownDialog.vue?0a56","webpack:///./shell/dialog/GenericPrompt.vue","webpack:///shell/dialog/GenericPrompt.vue","webpack:///./shell/dialog/GenericPrompt.vue?d375","webpack:///./shell/dialog/GenericPrompt.vue?4ea6"],"names":["content","__esModule","default","module","i","locals","exports","add","___CSS_LOADER_API_IMPORT___","push","render","_vm","this","_c","_self","_b","on","$event","$emit","config","slot","staticClass","allToDelete","length","_v","_s","t","type","safeMachinesToDelete","name","count","ignored","_l","directives","rawName","value","expression","key","_e","staticRenderFns","components","GenericPrompt","props","resources","Array","required","fetch","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","Promise","all","$store","dispatch","CAPI","MACHINE_DEPLOYMENT","MACHINE","stop","data","isArray","cluster","_this$deleteType","deleteType","_this$deleteType2","_slicedToArray","ignoredControlPlane","safeControlePlaneMachinesToDelete","_this$deleteType3","_this$deleteType4","ignoredEtcd","filter","getters","schema","title","applyMode","applyAction","remove","methods","allToDeleteByType","reduce","res","m","typed","others","totalTypes","machines","typesToDelete","ignoredType","pop","undefined","concat","_toConsumableArray","_this2","_callee2","poolInfo","flatArray","_context2","set","pool","get","Map","from","entries","map","_ref","_ref2","setAnnotation","CAPI_LABELS","DELETE_MACHINE","save","then","scalePool","component","attrs","_t","decodeHtml","body","staticStyle","errors","err","close","apply","Card","AsyncButton","Banner","Function","String","confirm","buttonDone","t0","console","error","exceptionToErrorsArray"],"mappings":"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","file":"js/dialog36.13996960.js","sourcesContent":["// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-3!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./ScaleMachineDownDialog.vue?vue&type=style&index=0&id=768cb740&prod&lang=scss&scoped=true&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"e4ab2e52\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","export * from \"-!../../node_modules/vue-style-loader/index.js??ref--9-oneOf-1-0!../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-3!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./ScaleMachineDownDialog.vue?vue&type=style&index=0&id=768cb740&prod&lang=scss&scoped=true&\"","export * from \"-!../../node_modules/vue-style-loader/index.js??ref--9-oneOf-1-0!../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-3!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./GenericPrompt.vue?vue&type=style&index=0&id=376502e7&prod&lang=scss&scoped=true&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/@vue/cli-service/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".prompt-restore[data-v-376502e7]{margin:0}.bottom[data-v-376502e7]{display:flex;flex-direction:column;flex:1}.bottom .banner[data-v-376502e7]{margin-top:0}.bottom .buttons[data-v-376502e7]{display:flex;justify-content:flex-end;width:100%}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/@vue/cli-service/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".body div[data-v-768cb740]:not(:last-of-type){padding-bottom:15px}.body .retained-machine[data-v-768cb740]{display:flex;flex-direction:column}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-3!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./GenericPrompt.vue?vue&type=style&index=0&id=376502e7&prod&lang=scss&scoped=true&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"72e3d4d9\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('GenericPrompt',_vm._b({on:{\"close\":function($event){return _vm.$emit('close')}}},'GenericPrompt',_vm.config,false),[_c('template',{slot:\"body\"},[_c('div',{staticClass:\"pl-10 pr-10 mt-20 mb-20 body\"},[(_vm.allToDelete.length === 1)?_c('div',[_vm._v(\"\\n        \"+_vm._s(_vm.t('promptRemove.attemptingToRemove', { type: _vm.type }))+\" \"),_c('b',[_vm._v(_vm._s(_vm.safeMachinesToDelete[0].name))])]):_c('div',[_vm._v(\"\\n        \"+_vm._s(_vm.t('promptScaleMachineDown.attemptingToRemove', { type: _vm.type, count: _vm.allToDelete.length }, true))+\"\\n      \")]),_vm._v(\" \"),(_vm.ignored.length)?_c('div',{staticClass:\"retained-machine\"},[_c('span',{staticClass:\"mb-20\"},[_vm._v(_vm._s(_vm.t('promptScaleMachineDown.retainedMachine1')))]),_vm._v(\" \"),_vm._l((_vm.ignored),function(i){return _c('span',{directives:[{name:\"clean-html\",rawName:\"v-clean-html\",value:(_vm.t('promptScaleMachineDown.retainedMachine2', { name: i.name }, true)),expression:\"t('promptScaleMachineDown.retainedMachine2', { name: i.name }, true)\"}],key:i.name})})],2):_vm._e()])])],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\nimport { CAPI as CAPI_LABELS } from '@shell/config/labels-annotations';\nimport { CAPI } from '@shell/config/types';\nimport GenericPrompt from './GenericPrompt';\n\nexport default {\n  components: { GenericPrompt },\n\n  props: {\n    resources: {\n      type:     Array,\n      required: true\n    }\n  },\n\n  async fetch() {\n    await Promise.all([\n      this.$store.dispatch('management/findAll', { type: CAPI.MACHINE_DEPLOYMENT }),\n      this.$store.dispatch('management/findAll', { type: CAPI.MACHINE })\n    ]);\n  },\n\n  data() {\n    const allToDelete = Array.isArray(this.resources) ? this.resources : [this.resources];\n    const cluster = allToDelete[0].cluster;\n\n    // Not all machines can be deleted, there must always be at least one left for roles control plane and etcd\n    // First ensure that at least one control plane exists... and then check from the remaining machines that at least one etcd exists\n    // This isn't optimisied, there may be cases that retaining a single machine with both roles would be better than retaining two with single roles\n    const [ignoredControlPlane, safeControlePlaneMachinesToDelete] = this.deleteType('isControlPlane', allToDelete, cluster);\n    const [ignoredEtcd, safeMachinesToDelete] = this.deleteType('isEtcd', safeControlePlaneMachinesToDelete, cluster);\n    const ignored = [ignoredControlPlane, ignoredEtcd].filter((i) => !!i);\n\n    return {\n      cluster,\n      allToDelete,\n      safeMachinesToDelete,\n      ignored,\n      type:   this.$store.getters['type-map/labelFor'](allToDelete[0].schema, allToDelete.length),\n      config: {\n        title:       this.t('promptRemove.title'),\n        applyMode:   'delete',\n        applyAction: this.remove,\n      }\n    };\n  },\n\n  methods: {\n    deleteType(type, allToDelete, cluster) {\n      const allToDeleteByType = allToDelete.reduce((res, m) => {\n        if (m[type]) {\n          res.typed.push(m);\n        } else {\n          res.others.push(m);\n        }\n\n        return res;\n      }, { typed: [], others: [] });\n\n      const totalTypes = cluster.machines.filter((m) => m[type]).length;\n      const typesToDelete = allToDeleteByType.typed.length;\n      // If we're attempting to remove all control plan machines.... ignore one\n      const ignoredType = totalTypes - typesToDelete === 0 ? allToDeleteByType.typed.pop() : undefined;\n      const safeMachinesToDelete = [...allToDeleteByType.typed, ...allToDeleteByType.others];\n\n      return [ignoredType, safeMachinesToDelete];\n    },\n\n    async remove() {\n      // Group machines into pools\n      const poolInfo = this.safeMachinesToDelete.reduce((res, m) => {\n        res.set(m.pool, res.get(m.pool) || []);\n        res.get(m.pool).push(m);\n\n        return res;\n      }, new Map());\n\n      // Mark all machines for deletion and then scale down their pool to the new size\n      const flatArray = Array.from(poolInfo.entries());\n\n      await Promise.all(flatArray.map(([pool, machines]) => {\n        return Promise\n          .all(machines.map((m) => {\n            m.setAnnotation(CAPI_LABELS.DELETE_MACHINE, 'true');\n\n            return m.save();\n          }))\n          .then(() => pool.scalePool(-machines.length, false));\n      }));\n\n      // Pool scale info is kept in the cluster itself, so now we've made the changes we can save them\n      await this.cluster.save();\n    }\n  }\n};\n</script>\n\n<template>\n  <GenericPrompt\n    v-bind=\"config\"\n    @close=\"$emit('close')\"\n  >\n    <template slot=\"body\">\n      <div class=\"pl-10 pr-10 mt-20 mb-20 body\">\n        <div v-if=\"allToDelete.length === 1\">\n          {{ t('promptRemove.attemptingToRemove', { type }) }} <b>{{ safeMachinesToDelete[0].name }}</b>\n        </div>\n        <div v-else>\n          {{ t('promptScaleMachineDown.attemptingToRemove', { type, count: allToDelete.length }, true) }}\n        </div>\n        <div\n          v-if=\"ignored.length\"\n          class=\"retained-machine\"\n        >\n          <span class=\"mb-20\">{{ t('promptScaleMachineDown.retainedMachine1') }}</span>\n          <span\n            v-for=\"i in ignored\"\n            :key=\"i.name\"\n            v-clean-html=\"t('promptScaleMachineDown.retainedMachine2', { name: i.name }, true)\"\n          />\n        </div>\n      </div>\n    </template>\n  </GenericPrompt>\n</template>\n\n<style lang='scss' scoped>\n  .body {\n    div:not(:last-of-type) {\n      padding-bottom: 15px;\n    }\n    .retained-machine {\n      display: flex;\n      flex-direction: column;\n    }\n  }\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--16-0!../../node_modules/babel-loader/lib/index.js??ref--16-1!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./ScaleMachineDownDialog.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--16-0!../../node_modules/babel-loader/lib/index.js??ref--16-1!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./ScaleMachineDownDialog.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ScaleMachineDownDialog.vue?vue&type=template&id=768cb740&scoped=true&\"\nimport script from \"./ScaleMachineDownDialog.vue?vue&type=script&lang=js&\"\nexport * from \"./ScaleMachineDownDialog.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ScaleMachineDownDialog.vue?vue&type=style&index=0&id=768cb740&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"768cb740\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('Card',{staticClass:\"prompt-restore\",attrs:{\"show-highlight-border\":false}},[_c('template',{slot:\"title\"},[_vm._t(\"title\",function(){return [_c('h4',{directives:[{name:\"clean-html\",rawName:\"v-clean-html\",value:(_vm.title),expression:\"title\"}],staticClass:\"text-default-text\",attrs:{\"slot\":\"title\"},slot:\"title\"})]})],2),_vm._v(\" \"),_c('template',{slot:\"body\"},[_vm._t(\"body\",function(){return [_c('div',{directives:[{name:\"clean-html\",rawName:\"v-clean-html\",value:(_vm.decodeHtml(_vm.body)),expression:\"decodeHtml(body)\"}],staticClass:\"pl-10 pr-10\",staticStyle:{\"min-height\":\"50px\",\"display\":\"flex\"}})]})],2),_vm._v(\" \"),_c('div',{staticClass:\"bottom\",attrs:{\"slot\":\"actions\"},slot:\"actions\"},[_vm._l((_vm.errors),function(err,i){return _c('Banner',{key:i,attrs:{\"color\":\"error\",\"label\":err}})}),_vm._v(\" \"),_c('div',{staticClass:\"buttons\"},[_c('button',{staticClass:\"btn role-secondary mr-10\",on:{\"click\":_vm.close}},[_vm._v(\"\\n        \"+_vm._s(_vm.t('generic.cancel'))+\"\\n      \")]),_vm._v(\" \"),_c('AsyncButton',{attrs:{\"mode\":_vm.applyMode},on:{\"click\":_vm.apply}})],1)],2)],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\nimport AsyncButton from '@shell/components/AsyncButton';\nimport { Card } from '@components/Card';\nimport { Banner } from '@components/Banner';\nimport { exceptionToErrorsArray } from '@shell/utils/error';\nimport { decodeHtml } from '@shell/utils/string';\n\nexport default {\n  components: {\n    Card,\n    AsyncButton,\n    Banner,\n  },\n  props: {\n    applyAction: {\n      type:    Function,\n      default: () => {}\n    },\n    applyMode: {\n      type:    String,\n      default: 'create'\n    },\n    title: {\n      type:    String,\n      default: ''\n    },\n    body: {\n      type:    String,\n      default: ''\n    },\n\n    /**\n     * Callback to identify response of the prompt\n     */\n    confirm: {\n      type:    Function,\n      default: () => { }\n    },\n  },\n  data() {\n    return { errors: [] };\n  },\n\n  methods: {\n    decodeHtml,\n    close() {\n      this.confirm(false);\n      this.$emit('close', false);\n    },\n\n    async apply(buttonDone) {\n      try {\n        await this.applyAction(buttonDone);\n        this.confirm(true);\n        this.$emit('close', true);\n      } catch (err) {\n        console.error(err); // eslint-disable-line\n        this.errors = exceptionToErrorsArray(err);\n        buttonDone(false);\n      }\n    }\n  },\n};\n</script>\n\n<template>\n  <Card\n    class=\"prompt-restore\"\n    :show-highlight-border=\"false\"\n  >\n    <template slot=\"title\">\n      <slot name=\"title\">\n        <h4\n          slot=\"title\"\n          v-clean-html=\"title\"\n          class=\"text-default-text\"\n        />\n      </slot>\n    </template>\n\n    <template slot=\"body\">\n      <slot name=\"body\">\n        <div\n          v-clean-html=\"decodeHtml(body)\"\n          class=\"pl-10 pr-10\"\n          style=\"min-height: 50px; display: flex;\"\n        />\n      </slot>\n    </template>\n\n    <div\n      slot=\"actions\"\n      class=\"bottom\"\n    >\n      <Banner\n        v-for=\"(err, i) in errors\"\n        :key=\"i\"\n        color=\"error\"\n        :label=\"err\"\n      />\n      <div class=\"buttons\">\n        <button\n          class=\"btn role-secondary mr-10\"\n          @click=\"close\"\n        >\n          {{ t('generic.cancel') }}\n        </button>\n\n        <AsyncButton\n          :mode=\"applyMode\"\n          @click=\"apply\"\n        />\n      </div>\n    </div>\n  </Card>\n</template>\n<style lang='scss' scoped>\n  .prompt-restore {\n    margin: 0;\n  }\n  .bottom {\n    display: flex;\n    flex-direction: column;\n    flex: 1;\n    .banner {\n      margin-top: 0\n    }\n    .buttons {\n      display: flex;\n      justify-content: flex-end;\n      width: 100%;\n    }\n  }\n\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--16-0!../../node_modules/babel-loader/lib/index.js??ref--16-1!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./GenericPrompt.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--16-0!../../node_modules/babel-loader/lib/index.js??ref--16-1!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./GenericPrompt.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./GenericPrompt.vue?vue&type=template&id=376502e7&scoped=true&\"\nimport script from \"./GenericPrompt.vue?vue&type=script&lang=js&\"\nexport * from \"./GenericPrompt.vue?vue&type=script&lang=js&\"\nimport style0 from \"./GenericPrompt.vue?vue&type=style&index=0&id=376502e7&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"376502e7\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}