(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages/c/_cluster/uiplugins/UninstallDialog"],{"1bc9":function(t,e,n){var a=n("3913");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=n("499e").default;i("09cac510",a,!0,{sourceMap:!1,shadowMode:!1})},3913:function(t,e,n){var a=n("4bad");e=a(!1),e.push([t.i,".plugin-install-dialog[data-v-c715056e]{padding:10px}.plugin-install-dialog h4[data-v-c715056e]{font-weight:700}.plugin-install-dialog .dialog-panel[data-v-c715056e]{display:flex;flex-direction:column;min-height:100px}.plugin-install-dialog .dialog-panel .dialog-info[data-v-c715056e]{flex:1}.plugin-install-dialog .dialog-buttons[data-v-c715056e]{display:flex;justify-content:flex-end;margin-top:10px}.plugin-install-dialog .dialog-buttons[data-v-c715056e]>:not(:last-child){margin-right:10px}",""]),t.exports=e},"61a4":function(t,e,n){"use strict";n("1bc9")},"94af":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t._self._c;return e("modal",{attrs:{name:"uninstallPluginDialog",height:"auto",scrollable:!0}},[t.plugin?e("div",{staticClass:"plugin-install-dialog"},[e("h4",{staticClass:"mt-10"},[t._v("\n      "+t._s(t.t("plugins.uninstall.title",{name:t.plugin.label}))+"\n    ")]),t._v(" "),e("div",{staticClass:"mt-10 dialog-panel"},[e("div",{staticClass:"dialog-info"},[e("p",[t._v("\n          "+t._s(t.plugin.catalog?t.t("plugins.uninstall.custom"):t.t("plugins.uninstall.prompt"))+"\n        ")])]),t._v(" "),e("div",{staticClass:"dialog-buttons"},[e("button",{staticClass:"btn role-secondary",attrs:{disabled:t.busy,"data-testid":"uninstall-ext-modal-cancel-btn"},on:{click:function(e){return t.closeDialog(!1)}}},[t._v("\n          "+t._s(t.t("generic.cancel"))+"\n        ")]),t._v(" "),e("AsyncButton",{attrs:{mode:"uninstall","data-testid":"uninstall-ext-modal-uninstall-btn"},on:{click:function(e){return t.uninstall()}}})],1)])]):t._e()])},i=[],l=(n("a4d3"),n("e439"),n("dbb4"),n("1da1")),s=n("ade3"),o=n("a34a"),r=n.n(o),c=(n("96cf"),n("b0c0"),n("4de4"),n("d3b7"),n("159b"),n("99af"),n("b64b"),n("2f62")),u=n("67c9"),d=n("a788"),p=n("7600"),g=n("fa98");function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){Object(s["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var b={components:{AsyncButton:u["b"]},data:function(){return{plugin:void 0,busy:!1}},computed:m({},Object(c["b"])({allCharts:"catalog/charts"})),methods:{showDialog:function(t){this.plugin=t,this.busy=!1,this.$modal.show("uninstallPluginDialog")},closeDialog:function(t){this.$modal.hide("uninstallPluginDialog"),this.$emit("closed",t)},uninstall:function(){var t=this;return Object(l["a"])(r.a.mark((function e(){var n,a,i,l;return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.busy=!0,a=t.plugin,t.$emit("update",a.name,"uninstall"),!(null!==(n=a.uiplugin)&&void 0!==n&&n.isDeveloper||a.catalog&&a.uiplugin)){e.next=6;break}return e.next=6,a.uiplugin.remove();case 6:return e.next=8,t.$store.dispatch("management/findAll",{type:d["f"].APP});case 8:if(i=e.sent,l=i.filter((function(e){if(a.catalog&&e.namespace===p["k"]){var n=t.allCharts.filter((function(t){var e,n;return t.repoName===(null===(e=a.repo)||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.name)}));return n.some((function(t){return t.chartName===e.metadata.name}))}return e.namespace===p["k"]&&e.name===a.name&&e})),!a.catalog){e.next=13;break}return e.next=13,t.removePluginImageResources(a.uiplugin);case 13:if(!l.length){e.next=17;break}try{l.forEach((function(t){return t.remove()}))}catch(s){t.$store.dispatch("growl/error",{title:t.t("plugins.error.generic"),message:s.message?s.message:s,timeout:1e4},{root:!0})}return e.next=17,t.$store.dispatch("management/findAll",{type:d["f"].OPERATION});case 17:t.closeDialog(a);case 18:case"end":return e.stop()}}),e)})))()},removePluginImageResources:function(t){var e=this;return Object(l["a"])(r.a.mark((function n(){var a,i,l,s,o,c,u,f;return r.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(l="".concat(p["j"].CATALOG_IMAGE,"=").concat(null===(a=t.metadata)||void 0===a||null===(i=a.labels)||void 0===i?void 0:i[p["j"].CATALOG_IMAGE]),s=p["k"],!l){n.next=7;break}return n.next=5,Object(g["a"])({deployment:e.$store.dispatch("management/findMatching",{type:d["eb"].DEPLOYMENT,selector:l,namespace:s}),service:e.$store.dispatch("management/findMatching",{type:d["T"],selector:l,namespace:s}),repo:e.$store.dispatch("management/findMatching",{type:d["f"].CLUSTER_REPO,selector:l})});case 5:for(o=n.sent,c=0,u=Object.keys(o);c<u.length;c++)f=u[c],o[f]&&o[f].forEach((function(t){return t.remove()}));case 7:case"end":return n.stop()}}),n)})))()}}},h=b,v=(n("61a4"),n("0c7c")),y=Object(v["a"])(h,a,i,!1,null,"c715056e",null);e["default"]=y.exports}}]);
//# sourceMappingURL=UninstallDialog.1ff89ef9.js.map