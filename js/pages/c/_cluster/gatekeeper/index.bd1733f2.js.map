{"version":3,"sources":["webpack:///./shell/utils/install-redirect.js","webpack:///./shell/pages/c/_cluster/gatekeeper/index.vue","webpack:///shell/pages/c/_cluster/gatekeeper/index.vue","webpack:///./shell/pages/c/_cluster/gatekeeper/index.vue?8535","webpack:///./shell/pages/c/_cluster/gatekeeper/index.vue?3b45","webpack:///./shell/components/ChartHeading.vue","webpack:///shell/components/ChartHeading.vue","webpack:///./shell/components/ChartHeading.vue?bc19","webpack:///./shell/components/ChartHeading.vue?751a"],"names":["product","chartName","defaultResourceOrRoute","install","arguments","length","undefined","_middleware","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_ref","_store$getters$curren","redirect","store","cluster","chart","_query","wrap","_context","prev","next","getters","id","_typeof","abrupt","name","params","resource","dispatch","force","query","_defineProperty","REPO_TYPE","repoType","REPO","repoName","CHART","VERSION","versions","version","concat","stop","middleware","_x","apply","render","_vm","this","_c","_self","attrs","t","_v","staticClass","headers","violations","staticRenderFns","components","ChartHeading","SortableTable","InstallRedirect","NAME","CHART_NAME","fetch","_this","constraints","constraint","t0","$store","type","GATEKEEPER","SPOOFED","CONSTRAINT","sent","map","i","constraintLink","text","nameDisplay","to","detailLocation","templateLink","kind","toLowerCase","count","totalViolations","data","ctx","CONSTRAINT_VIOLATION_CONSTRAINT_LINK","CONSTRAINT_VIOLATION_TEMPLATE_LINK","CONSTRAINT_VIOLATION_COUNT","component","_s","url","label","props","String","required"],"mappings":"wNAEe,gBAASA,EAASC,EAAWC,GAAwC,IAAhBC,IAAOC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,KAAAA,UAAA,GACzE,sBAAAG,EAAAC,eAAAC,IAAAC,MAAO,SAAAC,EAAAC,GAAA,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAAT,IAAAU,MAAA,SAAAC,GAAA,eAAAA,EAAAC,KAAAD,EAAAE,MAAA,OACyD,GAD7BR,EAAQF,EAARE,SAAUC,EAAKH,EAALG,MACrCC,GAAyC,QAA/BH,EAAAE,EAAMQ,QAAQ,yBAAiB,IAAAV,OAAA,EAA/BA,EAAiCW,KAAM,SAElDT,EAAMQ,QAAQ,4BAA4BvB,GAAQ,CAAAoB,EAAAE,KAAA,YAGhDpB,EAAsB,CAAAkB,EAAAE,KAAA,WACc,WAAlCG,eAAOvB,GAAmC,CAAAkB,EAAAE,KAAA,eAAAF,EAAAM,OAAA,SACtCZ,EAASZ,IAAuB,cAAAkB,EAAAM,OAAA,SAGlCZ,EAAS,CACda,KAAQ,6BACRC,OAAQ,CACNZ,UACAhB,UACA6B,SAAU3B,MAEZ,OAAAkB,EAAAE,KAAA,oBAIKnB,EAAS,CAAFiB,EAAAE,KAAA,gBAAAF,EAAAE,KAAA,GAGVP,EAAMe,SAAS,eAAgB,CAAEC,OAAO,IAAO,QAEM,GAArDd,EAAQF,EAAMQ,QAAQ,iBAAiB,CAAEtB,eAE1CgB,EAAK,CAAAG,EAAAE,KAAA,gBAAAF,EAAAM,OAAA,SACDZ,EAAS,CACda,KAAQ,8BACRC,OAAQ,CAAEZ,WACVgB,OAAKd,EAAA,GAAAe,eAAAf,EACFgB,OAAYjB,EAAMkB,UAAQF,eAAAf,EAC1BkB,OAAYnB,EAAMoB,UAAQJ,eAAAf,EAC1BoB,OAAYrB,EAAMhB,WAASgC,eAAAf,EAC3BqB,OAAYtB,EAAMuB,SAAS,GAAGC,SAAOvB,MAExC,QAGFH,EAAMe,SAAS,eAAgB,uBAAFY,OAA0B1C,IAAY,QAAAoB,EAAAE,KAAA,wBAAAF,EAAAM,OAAA,SAG9DZ,EAAS,CACda,KAAQ,qBACRC,OAAQ,CAAEZ,cACV,yBAAAI,EAAAuB,UAAAhC,OAEL,SAlDqBiC,EAAUC,GAAA,OAAAtC,EAAAuC,MAAC,KAAD1C,WAAA,OAAVwC,EAAtB,K,yCCHF,IAAIG,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACA,EAAG,eAAe,CAACE,MAAM,CAAC,MAAQJ,EAAIK,EAAE,6BAA6B,IAAM,qDAAqDL,EAAIM,GAAG,KAAKJ,EAAG,MAAM,CAACK,YAAY,WAAWP,EAAIM,GAAG,KAAKJ,EAAG,MAAM,CAACK,YAAY,SAAS,CAACL,EAAG,KAAK,CAACA,EAAG,IAAI,CAACE,MAAM,CAAC,EAAI,iCAAiC,KAAKJ,EAAIM,GAAG,KAAKJ,EAAG,MAAM,CAACA,EAAG,gBAAgB,CAACE,MAAM,CAAC,QAAUJ,EAAIQ,QAAQ,KAAOR,EAAIS,WAAW,QAAS,EAAM,iBAAgB,EAAM,eAAc,EAAM,QAAS,EAAK,gBAAgB,GAAG,YAAY,KAAK,WAAW,wBAAwB,IAAI,IAEnlBC,EAAkB,G,+HCKP,GACfC,WAAA,CAAAC,oBAAAC,sBACAjB,WAAAkB,eAAAC,UAAAC,iBACAC,MAAA,eAAAC,EAAA,YAAA1D,eAAAC,IAAAC,MAAA,SAAAC,IAAA,IAAAwD,EAAA,OAAA1D,IAAAU,MAAA,SAAAC,GAAA,eAAAA,EAAAC,KAAAD,EAAAE,MAAA,WACA4C,EAAAE,WAAA,CAAAhD,EAAAE,KAAA,QAAAF,EAAAiD,GAAA,CAAAH,EAAAE,YAAAhD,EAAAE,KAAA,sBAAAF,EAAAE,KAAA,EAAA4C,EAAAI,OAAAxC,SAAA,mBAAAyC,KAAAC,OAAAC,QAAAC,aAAA,OAAAtD,EAAAiD,GAAAjD,EAAAuD,KAAA,OAAAR,EAAA/C,EAAAiD,GAEAH,EAAAT,WAAAU,EACAS,KAAA,SAAAR,EAAAS,GAAA,OACArD,GAAAqD,EACAC,eAAA,CACAC,KAAAX,EAAAY,YACAC,GAAAb,EAAAc,gBAEAC,aAAA,CACAJ,KAAAX,EAAAgB,KACAH,GAAA,CACAtD,KAAA,gCACAC,OAAA,CACAC,SAAA,6CAAAL,GAAA4C,EAAAgB,KAAAC,cAAArF,QAAA,gBAIAsF,MAAAlB,EAAAmB,oBACA,wBAAAnE,EAAAuB,UAAAhC,MApBAH,IAsBAgF,KAAA,SAAAC,GACA,OACAjC,QAAA,CACAkC,OACAC,OACAC,QAEAnC,WAAA,MCvC+W,I,YCO3WoC,EAAY,eACd,EACA9C,EACAW,GACA,EACA,KACA,KACA,MAIa,aAAAmC,E,2CClBf,IAAI9C,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACK,YAAY,iBAAiB,CAACL,EAAG,KAAK,CAACF,EAAIM,GAAGN,EAAI8C,GAAG9C,EAAIK,EAAE,6BAA6BL,EAAIM,GAAG,OAAON,EAAI8C,GAAG9C,EAAIK,EAAE,2BAA2B,KAAKH,EAAG,IAAI,CAACE,MAAM,CAAC,KAAOJ,EAAI+C,IAAI,IAAM,+BAA+B,OAAS,WAAW,CAAC/C,EAAIM,GAAGN,EAAI8C,GAAG9C,EAAIgD,aAEtUtC,EAAkB,GCDP,GACfuC,MAAA,CACAD,MAAA,CACAzB,KAAA2B,OACAC,UAAA,GAEAJ,IAAA,CACAxB,KAAA2B,OACAC,UAAA,KCTkV,I,YCO9UN,EAAY,eACd,EACA9C,EACAW,GACA,EACA,KACA,KACA,MAIa,OAAAmC,E","file":"js/pages/c/_cluster/gatekeeper/index.bd1733f2.js","sourcesContent":["import { REPO_TYPE, REPO, CHART, VERSION } from '@shell/config/query-params';\n\nexport default function(product, chartName, defaultResourceOrRoute, install = true) {\n  return async function middleware({ redirect, store } ) {\n    const cluster = store.getters['currentCluster']?.id || 'local';\n\n    if ( store.getters['type-map/isProductActive'](product) ) {\n      // If the product is installed and there's a default resource, redirect there\n\n      if ( defaultResourceOrRoute ) {\n        if ( typeof defaultResourceOrRoute === 'object' ) {\n          return redirect(defaultResourceOrRoute);\n        }\n\n        return redirect({\n          name:   'c-cluster-product-resource',\n          params: {\n            cluster,\n            product,\n            resource: defaultResourceOrRoute\n          },\n        });\n      }\n\n      // Otherwise just let the middleware pass through\n    } else if (install) {\n      // The product is not installed, redirect to the details chart\n\n      await store.dispatch('catalog/load', { force: true });\n\n      const chart = store.getters['catalog/chart']({ chartName });\n\n      if ( chart ) {\n        return redirect({\n          name:   'c-cluster-apps-charts-chart',\n          params: { cluster },\n          query:  {\n            [REPO_TYPE]: chart.repoType,\n            [REPO]:      chart.repoName,\n            [CHART]:     chart.chartName,\n            [VERSION]:   chart.versions[0].version\n          },\n        });\n      } else {\n        // The chart's not available\n        store.dispatch('loadingError', `Chart not found for ${ product }`);\n      }\n    } else {\n      return redirect({\n        name:   'c-cluster-explorer',\n        params: { cluster },\n      });\n    }\n  };\n}\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('ChartHeading',{attrs:{\"label\":_vm.t('gatekeeperIndex.poweredBy'),\"url\":\"https://github.com/open-policy-agent/gatekeeper\"}}),_vm._v(\" \"),_c('div',{staticClass:\"spacer\"}),_vm._v(\" \"),_c('div',{staticClass:\"mb-10\"},[_c('h2',[_c('t',{attrs:{\"k\":\"gatekeeperIndex.violations\"}})],1)]),_vm._v(\" \"),_c('div',[_c('SortableTable',{attrs:{\"headers\":_vm.headers,\"rows\":_vm.violations,\"search\":false,\"table-actions\":false,\"row-actions\":false,\"paging\":true,\"rows-per-page\":10,\"key-field\":\"id\",\"group-by\":\"templateLink.text\"}})],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\nimport { NAME, CHART_NAME } from '@shell/config/product/gatekeeper';\nimport InstallRedirect from '@shell/utils/install-redirect';\nimport ChartHeading from '@shell/components/ChartHeading';\nimport SortableTable from '@shell/components/SortableTable';\nimport { CONSTRAINT_VIOLATION_CONSTRAINT_LINK, CONSTRAINT_VIOLATION_COUNT, CONSTRAINT_VIOLATION_TEMPLATE_LINK } from '@shell/config/table-headers';\nimport { GATEKEEPER } from '@shell/config/types';\nexport default {\n  components: { ChartHeading, SortableTable },\n  middleware: InstallRedirect(NAME, CHART_NAME),\n  async fetch() {\n    const constraints = this.constraint ? [this.constraint] : await this.$store.dispatch('cluster/findAll', { type: GATEKEEPER.SPOOFED.CONSTRAINT });\n\n    this.violations = constraints\n      .map((constraint, i) => ({\n        id:             i,\n        constraintLink: {\n          text: constraint.nameDisplay,\n          to:   constraint.detailLocation\n        },\n        templateLink: {\n          text: constraint.kind,\n          to:   {\n            name:   'c-cluster-product-resource-id',\n            params: {\n              resource: 'templates.gatekeeper.sh.constrainttemplate', id: constraint.kind.toLowerCase(), product: 'gatekeeper'\n            }\n          }\n        },\n        count: constraint.totalViolations\n      }));\n  },\n  data(ctx) {\n    return {\n      headers: [\n        CONSTRAINT_VIOLATION_CONSTRAINT_LINK,\n        CONSTRAINT_VIOLATION_TEMPLATE_LINK,\n        CONSTRAINT_VIOLATION_COUNT\n      ],\n      violations: []\n    };\n  }\n};\n</script>\n\n<template>\n  <div>\n    <ChartHeading\n      :label=\"t('gatekeeperIndex.poweredBy')\"\n      url=\"https://github.com/open-policy-agent/gatekeeper\"\n    />\n    <div class=\"spacer\" />\n    <div class=\"mb-10\">\n      <h2><t k=\"gatekeeperIndex.violations\" /></h2>\n    </div>\n    <div>\n      <SortableTable\n        :headers=\"headers\"\n        :rows=\"violations\"\n        :search=\"false\"\n        :table-actions=\"false\"\n        :row-actions=\"false\"\n        :paging=\"true\"\n        :rows-per-page=\"10\"\n        key-field=\"id\"\n        group-by=\"templateLink.text\"\n      />\n    </div>\n  </div>\n</template>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--16-0!../../../../../node_modules/babel-loader/lib/index.js??ref--16-1!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--16-0!../../../../../node_modules/babel-loader/lib/index.js??ref--16-1!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=6754edbf&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"chart-heading\"},[_c('h1',[_vm._v(_vm._s(_vm.t('chartHeading.overview')))]),_vm._v(\"\\n  \"+_vm._s(_vm.t('chartHeading.poweredBy'))+\" \"),_c('a',{attrs:{\"href\":_vm.url,\"rel\":\"nofollow noopener noreferrer\",\"target\":\"_blank\"}},[_vm._v(_vm._s(_vm.label))])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\nexport default {\n  props: {\n    label: {\n      type:     String,\n      required: true\n    },\n    url: {\n      type:     String,\n      required: true\n    }\n  }\n};\n</script>\n\n<template>\n  <div class=\"chart-heading\">\n    <h1>{{ t('chartHeading.overview') }}</h1>\n    {{ t('chartHeading.poweredBy') }} <a\n      :href=\"url\"\n      rel=\"nofollow noopener noreferrer\"\n      target=\"_blank\"\n    >{{ label }}</a>\n  </div>\n</template>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--16-0!../../node_modules/babel-loader/lib/index.js??ref--16-1!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./ChartHeading.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--16-0!../../node_modules/babel-loader/lib/index.js??ref--16-1!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./ChartHeading.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ChartHeading.vue?vue&type=template&id=3fa1a3e2&\"\nimport script from \"./ChartHeading.vue?vue&type=script&lang=js&\"\nexport * from \"./ChartHeading.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}