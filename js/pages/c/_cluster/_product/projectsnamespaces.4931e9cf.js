(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages/c/_cluster/_product/projectsnamespaces"],{"0513":function(e,t,r){"use strict";r("3055")},"2d67":function(e,t,r){"use strict";r("e797")},3055:function(e,t,r){var a=r("f733");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var o=r("499e").default;o("7e910a1e",a,!0,{sourceMap:!1,shadowMode:!1})},e797:function(e,t,r){var a=r("f135");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var o=r("499e").default;o("7e93f73b",a,!0,{sourceMap:!1,shadowMode:!1})},f135:function(e,t,r){var a=r("4bad");t=a(!1),t.push([e.i,".project-namespaces[data-v-45db6e32] .project-name{line-height:30px}.project-namespaces[data-v-45db6e32] .project-bar{display:flex;flex-direction:row;justify-content:space-between}.project-namespaces[data-v-45db6e32] .project-bar.has-description .right{margin-top:5px}.project-namespaces[data-v-45db6e32] .project-bar.has-description .group-tab,.project-namespaces[data-v-45db6e32] .project-bar.has-description .group-tab:after{height:50px}.project-namespaces[data-v-45db6e32] .project-bar.has-description .group-tab:after{right:-20px}.project-namespaces[data-v-45db6e32] .project-bar.has-description .group-tab .description{margin-top:-20px}.project-namespaces[data-v-45db6e32] .namespace-name{display:flex;align-items:center}.project-namespaces[data-v-45db6e32] .namespace-name .icon-istio{color:var(--primary)}",""]),e.exports=t},f733:function(e,t,r){var a=r("4bad");t=a(!1),t.push([e.i,".psa-tooltip{margin:3px 0;padding:0 8px 0 22px}",""]),e.exports=t},fdba:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("ExplorerProjectsNamespaces",e._b({},"ExplorerProjectsNamespaces",e.$attrs,!1))},o=[],n=(r("b0c0"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"project-namespaces"},[t("Masthead",{attrs:{schema:e.projectSchema,"type-display":e.t("projectNamespaces.label"),resource:e.MANAGEMENT.PROJECT,"favorite-resource":e.VIRTUAL_TYPES.PROJECT_NAMESPACES,"create-location":e.createProjectLocation,"create-button-label":e.t("projectNamespaces.createProject"),"show-incremental-loading-indicator":e.showIncrementalLoadingIndicator,"load-resources":e.loadResources,"load-indeterminate":e.loadIndeterminate}},[e.showCreateNsButton?t("template",{slot:"extraActions"},[t("n-link",{staticClass:"btn role-primary mr-10",attrs:{to:e.createNamespaceLocationFlatList(),"data-testid":"create_project_namespaces"}},[e._v("\n        "+e._s(e.t("projectNamespaces.createNamespace"))+"\n      ")])],1):e._e()],2),e._v(" "),t("ResourceTable",e._g(e._b({ref:"table",staticClass:"table",attrs:{schema:e.schema,headers:e.headers,rows:e.filteredRows,groupable:!0,"sort-generation-fn":e.sortGenerationFn,loading:e.loading,"group-tooltip":"resourceTable.groupBy.project","key-field":"_key"},scopedSlots:e._u([{key:"group-by",fn:function(r){return[t("div",{staticClass:"project-bar",class:{"has-description":e.projectDescription(r.group)}},[t("div",{directives:[{name:"trim-whitespace",rawName:"v-trim-whitespace"}],staticClass:"group-tab"},[t("div",{directives:[{name:"clean-html",rawName:"v-clean-html",value:e.projectLabel(r.group),expression:"projectLabel(group.group)"}],staticClass:"project-name"}),e._v(" "),e.projectDescription(r.group)?t("div",{staticClass:"description text-muted text-small"},[e._v("\n            "+e._s(e.projectDescription(r.group))+"\n          ")]):e._e()]),e._v(" "),t("div",{staticClass:"right"},[e.isNamespaceCreatable&&(e.canSeeProjectlessNamespaces||r.group.key!==e.notInProjectKey)?t("n-link",{staticClass:"create-namespace btn btn-sm role-secondary mr-5",attrs:{to:e.createNamespaceLocation(r.group)}},[e._v("\n            "+e._s(e.t("projectNamespaces.createNamespace"))+"\n          ")]):e._e(),e._v(" "),t("button",{staticClass:"project-action btn btn-sm role-multi-action actions mr-10",class:{invisible:!e.showProjectActionButton(r.group)},attrs:{type:"button"},on:{click:function(t){return e.showProjectAction(t,r.group)}}},[t("i",{staticClass:"icon icon-actions"})])],1)])]}},{key:"cell:project",fn:function(r){var a=r.row;return[a.project?t("span",[e._v(e._s(a.project.nameDisplay))]):t("span",{staticClass:"text-muted"},[e._v("â€“")])]}},{key:"cell:name",fn:function(r){var a=r.row;return[t("div",{staticClass:"namespace-name"},[a.detailLocation&&!a.hideDetailLocation?t("n-link",{attrs:{to:a.detailLocation}},[e._v("\n          "+e._s(a.name)+"\n        ")]):t("span",[e._v("\n          "+e._s(a.name)+"\n        ")]),e._v(" "),a.injectionEnabled?t("i",{directives:[{name:"clean-tooltip",rawName:"v-clean-tooltip",value:e.t("projectNamespaces.isIstioInjectionEnabled"),expression:"t('projectNamespaces.isIstioInjectionEnabled')"}],staticClass:"icon icon-istio ml-5"}):e._e(),e._v(" "),a.hasSystemLabels?t("i",{directives:[{name:"clean-tooltip",rawName:"v-clean-tooltip",value:e.getPsaTooltip(a),expression:"getPsaTooltip(row)"}],staticClass:"icon icon-lock ml-5"}):e._e()],1)]}},e._l(e.projectsWithoutNamespaces,(function(r){return{key:e.slotName(r),fn:function(){return[t("tr",{key:r.id,staticClass:"main-row"},[t("td",{staticClass:"empty text-center",attrs:{colspan:"5"}},[e._v("\n          "+e._s(e.t("projectNamespaces.noNamespaces"))+"\n        ")])])]},proxy:!0}})),{key:"main-row:fake-empty",fn:function(){return[t("tr",{staticClass:"main-row"},[t("td",{staticClass:"empty text-center",attrs:{colspan:"5"}},[e._v("\n          "+e._s(e.t("projectNamespaces.noProjectNoNamespaces"))+"\n        ")])])]},proxy:!0}],null,!0)},"ResourceTable",e.$attrs,!1),e.$listeners)),e._v(" "),t("MoveModal",{on:{moving:e.clearSelection}})],1)}),c=[],s=(r("e439"),r("159b"),r("dbb4"),r("fb6a"),r("a630"),r("3ca3"),r("ac1f"),r("d28b"),r("e260"),r("ddb0"),r("3835")),i=r("2909"),u=r("ade3"),p=r("1da1"),l=(r("caad"),r("2532"),r("4de4"),r("d3b7"),r("d81d"),r("7db0"),r("8a79"),r("99af"),r("b64b"),r("a15b"),r("4e82"),r("07ac"),r("a4d3"),r("e01a"),r("a34a")),d=r.n(l),m=(r("96cf"),r("2f62")),f=r("b178"),h=r("9149"),v=r("f303"),j=r("a788"),b=r("fa3b"),g=r("39ce"),y=r("e528"),P=r("e115"),N=r("ccc6"),w=r("2730"),O=r("c0c4"),_=r.n(O);function S(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=L(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,c=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){s=!0,n=e},f:function(){try{c||null==r.return||r.return()}finally{if(s)throw n}}}}function L(e,t){if(e){if("string"===typeof e)return C(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?C(e,t):void 0}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){Object(u["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var k={name:"ListProjectNamespace",components:{Masthead:g["a"],MoveModal:P["a"],ResourceTable:f["a"]},mixins:[w["a"]],props:{createProjectLocationOverride:{type:Object,default:function(){return null}},createNamespaceLocationOverride:{type:Object,default:function(){return null}}},fetch:function(){var e=this;return Object(p["a"])(d.a.mark((function t(){var r;return d.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.$store.getters["currentStore"](j["D"]),e.schema=e.$store.getters["".concat(r,"/schemaFor")](j["D"]),e.projectSchema=e.$store.getters["management/schemaFor"](j["A"].PROJECT),e.schema){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,e.$fetchType(j["D"]);case 7:return t.next=9,e.$store.dispatch("management/findAll",{type:j["A"].PROJECT,opt:{force:!0}});case 9:e.projects=t.sent;case 10:case"end":return t.stop()}}),t)})))()},data:function(){return{loadResources:[j["D"]],loadIndeterminate:!0,schema:null,projects:[],projectSchema:null,MANAGEMENT:j["A"],VIRTUAL_TYPES:j["cb"],defaultCreateProjectLocation:{name:"c-cluster-product-resource-create",params:{product:this.$store.getters["currentProduct"].name,resource:j["A"].PROJECT}}}},computed:A(A({},Object(m["b"])(["currentCluster","currentProduct"])),{},{namespaces:function(){var e=this.$store.getters["currentStore"](j["D"]);return this.$store.getters["".concat(e,"/all")](j["D"])},loading:function(){return!(!this.currentCluster||this.namespaces.length)&&this.$fetchState.pending},showIncrementalLoadingIndicator:function(){var e,t;return null===(e=this.perfConfig)||void 0===e||null===(t=e.incrementalLoading)||void 0===t?void 0:t.enabled},isNamespaceCreatable:function(){var e;return((null===(e=this.schema)||void 0===e?void 0:e.collectionMethods)||[]).includes("POST")},headers:function(){var e={name:"project",label:this.t("tableHeaders.project"),value:"project.nameDisplay",sort:["projectNameSort","nameSort"]};return[h["xb"],h["X"],"none"===this.groupPreference?e:null,h["b"]].filter((function(e){return e}))},projectIdsWithNamespaces:function(){var e=this.rows.map((function(e){return e.projectId})).filter((function(e){return e}));return Object(v["n"])(e)},clusterProjects:function(){var e,t,r=this.currentCluster.id,a=this.$store.getters["management/all"](j["A"].PROJECT);if(null!==(e=this.currentProduct)&&void 0!==e&&e.customNamespaceFilter&&null!==(t=this.currentProduct)&&void 0!==t&&t.inStore&&this.$store.getters["".concat(this.currentProduct.inStore,"/filterProject")])return this.$store.getters["".concat(this.currentProduct.inStore,"/filterProject")];var o=a.filter((function(e){return e.spec.clusterName===r}));return o},projectsWithoutNamespaces:function(){var e=this;return this.activeProjects.filter((function(t){return!e.projectIdsWithNamespaces.find((function(e){var r;return null===t||void 0===t||null===(r=t.id)||void 0===r?void 0:r.endsWith("/".concat(e))}))}))},rowsWithFakeNamespaces:function(){var e=this.projectsWithoutNamespaces.map((function(e){var t;return{groupByLabel:"resourceTable.groupLabel.notInAProject".concat("-",e.id),isFake:!0,mainRowKey:e.id,nameDisplay:null===(t=e.spec)||void 0===t?void 0:t.displayName,project:e,availableActions:[]}}));return this.showMockNotInProjectGroup&&e.push({groupByLabel:this.t("resourceTable.groupLabel.notInAProject"),mainRowKey:"fake-empty"}),[].concat(Object(i["a"])(this.rows),Object(i["a"])(e))},createProjectLocation:function(){return this.createProjectLocationOverride||this.defaultCreateProjectLocation},groupPreference:Object(y["mapPref"])(y["GROUP_RESOURCES"]),activeNamespaceFilters:function(){return this.$store.getters["activeNamespaceFilters"]},activeProjectFilters:function(){var e,t={},r=S(this.activeNamespaceFilters);try{for(r.s();!(e=r.n()).done;){var a=e.value,o=a.split("://",2),n=Object(s["a"])(o,2),c=n[0],i=n[1];"project"===c&&(t[i]=!0)}}catch(u){r.e(u)}finally{r.f()}return t},activeProjects:function(){var e=this,t=this.$store.getters["activeNamespaceFilters"];return t.includes(N["b"])&&0===Object.keys(this.activeProjectFilters).length?[]:this.userIsFilteringForSpecificNamespaceOrProject()?this.clusterProjects.filter((function(t){var r=t.id.split("/")[1];return!!e.activeProjectFilters[r]})):this.clusterProjects},activeNamespaces:function(){var e=this.$store.getters["namespaces"]();return this.namespaces.filter((function(t){return!!e[t.metadata.name]}))},filteredRows:function(){return"none"===this.groupPreference?this.rows:this.rowsWithFakeNamespaces},rows:function(){var e=this;return this.$store.getters["prefs/get"](y["ALL_NAMESPACES"])?this.activeNamespaces:this.activeNamespaces.filter((function(t){var r,a=e.$store.getters["systemNamespaces"].includes(t.metadata.name),o=t.isSystem||t.isFleetManaged||a;return null===(r=e.currentProduct)||void 0===r||!r.hideSystemResources||!o}))},canSeeProjectlessNamespaces:function(){return this.currentCluster.canUpdate},showMockNotInProjectGroup:function(){if(!this.canSeeProjectlessNamespaces)return!1;var e=!this.rows.some((function(e){return!e.project})),t=this.userIsFilteringForSpecificNamespaceOrProject();return!t&&e},notInProjectKey:function(){return this.$store.getters["i18n/t"]("resourceTable.groupLabel.notInAProject")},showCreateNsButton:function(){return"namespace"!==this.groupPreference}}),methods:{getPsaTooltip:function(e){var t=e.psaTooltipsDescription,r=Object.values(t).sort().map((function(e){return"<li>".concat(e,"</li>")})).join(""),a="<p>".concat(this.t("podSecurityAdmission.name"),": </p>");return"".concat(a,'<ul class="psa-tooltip">').concat(r,"</ul>")},userIsFilteringForSpecificNamespaceOrProject:function(){for(var e=this.$store.getters["namespaceFilters"],t=0;t<e.length;t++){var r=e[t],a=r.split("://")[0];if("ns"===a||"project"===a)return!0}return!1},slotName:function(e){return"main-row:".concat(e.id)},createNamespaceLocation:function(e){var t=e.rows[0].project,r=this.createNamespaceLocationOverride?A({},this.createNamespaceLocationOverride):{name:"c-cluster-product-resource-create",params:{product:this.$store.getters["currentProduct"].name,resource:j["D"]}};return r.query=Object(u["a"])({},b["y"],null===t||void 0===t?void 0:t.metadata.name),r},createNamespaceLocationFlatList:function(){var e,t=this.createNamespaceLocationOverride?A({},this.createNamespaceLocationOverride):{name:"c-cluster-product-resource-create",params:{product:null===(e=this.$store.getters["currentProduct"])||void 0===e?void 0:e.name,resource:j["D"]}};return t.query=Object(u["a"])({},b["h"],!0),t},showProjectAction:function(e,t){var r=t.rows[0].project;this.$store.commit("action-menu/show",{resources:[r],elem:e.target})},showProjectActionButton:function(e){var t=e.rows[0].project;return!!t},projectLabel:function(e){var t,r=e.rows[0];return r.isFake?_.a.sanitize(this.t("resourceTable.groupLabel.project",{name:null===(t=r.project)||void 0===t?void 0:t.nameDisplay},!0),{ALLOWED_TAGS:["span"]}):r.groupByLabel},projectDescription:function(e){var t=e.rows[0].project;return null===t||void 0===t?void 0:t.description},clearSelection:function(){this.$refs.table.clearSelection()},sortGenerationFn:function(){var e=Object(f["b"])(this.schema,this.$store);return e+(this.showMockNotInProjectGroup?"-mock":"")}}},I=k,E=(r("2d67"),r("0513"),r("0c7c")),T=Object(E["a"])(I,n,c,!1,null,"45db6e32",null),$=T.exports,F={components:{ExplorerProjectsNamespaces:$}},M=F,D=Object(E["a"])(M,a,o,!1,null,null,null);t["default"]=D.exports}}]);
//# sourceMappingURL=projectsnamespaces.4931e9cf.js.map